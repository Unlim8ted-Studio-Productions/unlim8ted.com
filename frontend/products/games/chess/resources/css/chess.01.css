:root{
      --bg: #0b0f17;
      --panel: rgba(255,255,255,0.06);
      --panel2: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --line: rgba(255,255,255,0.10);
      --accent: #39c891;
      --accent2:#7c5cff;
      --danger:#ff5c7a;

      --board-light:#f0d9b5;
      --board-dark:#b58863;
      --hl-last: rgba(57,200,145,0.35);
      --hl-selected: rgba(124,92,255,0.40);
      --hl-check: rgba(255,92,122,0.45);
      --dot: rgba(0,0,0,0.18);
      --dot-capture: rgba(0,0,0,0.28);

      --radius: 16px;
      --radius2: 12px;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --shadow2: 0 8px 22px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --ui: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family:var(--ui);
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 20% 10%, rgba(124,92,255,.28), transparent 60%),
        radial-gradient(900px 650px at 90% 15%, rgba(57,200,145,.22), transparent 55%),
        radial-gradient(900px 700px at 50% 100%, rgba(255,92,122,.10), transparent 60%),
        var(--bg);
      padding: 16px;
    }
.board{grid-template-rows: repeat(8, 1fr);
 
  width: min(560px, 86vw);
  height: min(560px, 86vw);     /* force square */
  aspect-ratio: auto;          /* not needed anymore */
  display:grid;
  grid-template-columns: repeat(8, 1fr);
  border-radius: 18px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 22px 70px rgba(0,0,0,.40);
  margin: 0 auto;
  background: rgba(255,255,255,0.04);
  position: relative;
  user-select:none;
  touch-action: manipulation;
}
.board-card{ overflow: hidden; }
/* piece colors (emoji text color) */
.sq{
  color: var(--white-piece);
  text-shadow: 0 1px 0 rgba(0,0,0,.25);
}
.sq.black-piece{
  color: var(--black-piece);
  text-shadow: 0 1px 0 rgba(0,0,0,.35);
}

/* default theme piece colors */
:root{
  --white-piece: rgba(255,255,255,.95);
  --black-piece: rgba(10,10,12,.92);
}

    .app{
      max-width: 1100px;
      margin: 0 auto;
      padding-top: 70px;
    }

    /* Modern glass panels */
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.05));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(10px);
    }

    /* Top HUD */
    .hud{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 12px 14px;
      margin-bottom: 14px;
    }
    .hud-left{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 0;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
    }
    .brand b{letter-spacing:.2px}
    .pill{
      font-size:12px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      display:inline-flex;
      gap:8px;
      align-items:center;
      white-space:nowrap;
    }
    .pill strong{color:var(--text); font-weight:700}
    .hud-right{
      display:flex;
      align-items:center;
      gap:10px;
    }

    button{
      appearance:none;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.08);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-weight: 650;
      letter-spacing: .15px;
    }
    button:hover{
      background: rgba(255,255,255,0.12);
      border-color: rgba(255,255,255,0.18);
      transform: translateY(-1px);
    }
    button:active{transform: translateY(0px) scale(.99)}
    button.primary{
      border-color: rgba(57,200,145,0.45);
      background: rgba(57,200,145,0.18);
    }
    button.primary:hover{background: rgba(57,200,145,0.26)}
    button.ghost{
      background: transparent;
      border-color: rgba(255,255,255,0.14);
    }
    .icon-btn{
      width: 42px;
      height: 42px;
      display:grid;
      place-items:center;
      padding:0;
      border-radius: 14px;
    }
    .icon{
      width: 20px; height: 20px;
      display:block;
      fill: currentColor;
    }

    /* Layout */
    .grid{
      display:grid;
      grid-template-columns: 1fr 340px;
      gap: 14px;
      align-items:start;
    }

    @media (max-width: 980px){
      .grid{grid-template-columns: 1fr}
    }

    /* Board card */
    .board-card{
      padding: 14px;
    }

    .board-wrap{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .board{
      width: min(560px, 86vw);
      aspect-ratio: 1 / 1;
      display:grid;
      grid-template-columns: repeat(8, 1fr);
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,0.10);
      box-shadow: 0 22px 70px rgba(0,0,0,.40);
      margin: 0 auto;
      background: rgba(255,255,255,0.04);
      position: relative;
      user-select:none;
      touch-action: manipulation;
    }

    .sq{
      position:relative;
      display:grid;
      place-items:center;
      font-size: clamp(28px, 4.8vw, 44px);
      line-height: 1;
      cursor:pointer;
      transition: filter .08s ease;
    }

    .light{ background: var(--board-light); }
    .dark{  background: var(--board-dark); }
    .sq:hover{ filter: brightness(1.03); }

    .sq.selected::after{
      content:"";
      position:absolute;
      inset: 0;
      background: var(--hl-selected);
      outline: 2px solid rgba(124,92,255,0.55);
      outline-offset:-2px;
      pointer-events:none;
    }
    .sq.last::after{
      content:"";
      position:absolute;
      inset: 0;
      background: var(--hl-last);
      pointer-events:none;
    }
    .sq.check::after{
      content:"";
      position:absolute;
      inset: 0;
      background: var(--hl-check);
      pointer-events:none;
    }

    .dot{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--dot);
      position:absolute;
      inset: 0;
      margin:auto;
      pointer-events:none;
    }
    .dot.capture{
      width: 52%;
      height: 52%;
      border: 3px solid rgba(0,0,0,0.25);
      background: transparent;
      border-radius: 999px;
    }

    .coords{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color: var(--muted);
      font-family: var(--mono);
      font-size: 12px;
      opacity:.9;
      margin: 0 auto;
      width: min(560px, 86vw);
    }

    /* Side panel */
    .side{
      padding: 14px;
      display:flex;
      flex-direction:column;
      gap: 12px;
      position: sticky;
      top: 86px;
    }
    @media (max-width: 980px){
      .side{position: static}
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .stat{
      font-family: var(--mono);
      font-size: 13px;
      color: var(--muted);
    }
    .stat strong{color: var(--text)}

    .select{
      width: 100%;
      border:1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.07);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 650;
    }

    .status{
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      font-weight: 700;
    }
    .status small{
      display:block;
      margin-top:4px;
      color: var(--muted);
      font-weight: 600;
    }

    .log{
      max-height: 220px;
      overflow:auto;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.22);
      padding: 10px;
    }
    .log ul{margin:0; padding:0; list-style:none}
    .log li{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding: 8px 8px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      font-family: var(--mono);
      font-size: 12px;
      color: rgba(255,255,255,0.82);
    }
    .log li:last-child{border-bottom:none}
    .tag{
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      color: rgba(255,255,255,0.85);
      background: rgba(255,255,255,0.06);
      white-space: nowrap;
      align-self:center;
    }
    .tag.w{border-color: rgba(57,200,145,.35)}
    .tag.b{border-color: rgba(255,92,122,.35)}

    /* Menus / Modals */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      padding: 18px;
      background: rgba(0,0,0,0.60);
      backdrop-filter: blur(8px);
      z-index: 3000;
    }
    .modal{
      width: min(680px, 96vw);
      padding: 16px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.12);
      background: linear-gradient(180deg, rgba(18,23,36,0.92), rgba(10,14,22,0.92));
      box-shadow: var(--shadow);
    }
    .modal h1, .modal h2{margin: 6px 0 10px}
    .modal p{margin: 0 0 12px; color: var(--muted); line-height: 1.45}
    .menu-grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 560px){
      .menu-grid{grid-template-columns: 1fr}
    }
    .menu-card{
      padding: 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.06);
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .menu-card h3{
      margin:0;
      display:flex;
      gap:10px;
      align-items:center;
      font-size: 16px;
    }
    .menu-card h3 svg{opacity:.95}
    .menu-card small{color: var(--muted)}
    .menu-actions{display:flex; gap:10px; flex-wrap:wrap}
    .footer{
      margin-top: 10px;
      color: rgba(255,255,255,0.55);
      font-size: 12px;
      text-align:center;
    }

    .settings-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 740px){
      .settings-grid{grid-template-columns: 1fr}
    }
    .field{
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
    }
    .field h4{margin:0 0 10px}
    .radio{
      display:flex;
      gap:10px;
      align-items:center;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.16);
      cursor:pointer;
      margin-bottom: 8px;
    }
    .radio:hover{background: rgba(0,0,0,0.22)}
    .swatches{display:flex; gap:6px; margin-left:auto}
    .swatch{width:18px; height:18px; border-radius: 6px; border:1px solid rgba(255,255,255,0.10)}
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .toggle input{transform: scale(1.1)}
    .kbd{
      font-family: var(--mono);
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 8px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.85);
    }

    /* Themes (board colors only) */
    .theme-default{
      --board-light:#f0d9b5;
      --board-dark:#b58863;
      --hl-last: rgba(57,200,145,0.35);
      --hl-selected: rgba(124,92,255,0.40);
      --hl-check: rgba(255,92,122,0.45);
    }
    .theme-neon{
      --board-light:#141414;
      --board-dark:#000000;
      --hl-last: rgba(0,255,120,0.30);
      --hl-selected: rgba(255,0,255,0.30);
      --hl-check: rgba(255,0,0,0.30);
      --dot: rgba(255,255,255,0.16);
      --dot-capture: rgba(255,255,255,0.22);
    }
    .theme-forest{
      --board-light:#c9dbc5;
      --board-dark:#769656;
      --hl-last: rgba(148,189,143,0.40);
      --hl-selected: rgba(247,226,107,0.45);
      --hl-check: rgba(232,72,85,0.40);
    }
